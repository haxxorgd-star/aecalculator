<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Energy & Damage Calculator</title>
<style>
body {
  font-family: "Segoe UI", Roboto, sans-serif;
  background: radial-gradient(circle at center, #0a1a2f 0%, #000814 100%);
  color: #cde4ff;
  margin: 0;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Top buttons */
.top-buttons { display: flex; gap: 25px; margin-bottom: 35px; }
.top-buttons button {
  padding: 18px 36px;
  font-size: 1.45rem;
  border: none;
  border-radius: 16px;
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
}
.top-buttons button:hover { transform: scale(1.05); }
.active-btn.energy { box-shadow: 0 0 18px #3399ff; }
.active-btn.damage { box-shadow: 0 0 18px #ff3333; }

.energy-btn { background: linear-gradient(90deg, #0066ff, #00ccff); color: #fff; }
.damage-btn { background: linear-gradient(90deg, #ff3300, #ff6666); color: #fff; }

/* Sections */
.section { display: none; flex-direction: column; align-items: center; width: 100%; max-width: 700px; }
.section.active { display: flex; }

h2 { margin: 0 0 16px 0; font-size: 2.2rem; }

.notice { font-size: 1.15rem; background: rgba(0,102,255,0.2); padding: 10px 16px; border-radius: 14px; margin-bottom: 18px; text-align: center; width: 100%; }

/* Tabs */
.tabs { display: flex; gap: 14px; margin-bottom: 20px; }
.tab-btn { flex: 1; padding: 14px 0; border-radius: 14px; background: rgba(0,30,60,0.4); border: none; color: #cde4ff; cursor: pointer; font-weight: bold; font-size: 1.2rem; }
.tab-btn.active-tab.energy { background: rgba(0,102,255,0.6); color: #fff; }
.tab-btn.active-tab.damage { background: rgba(255,50,50,0.7); color: #fff; }

.tab-content { display: none; flex-direction: column; align-items: center; width: 100%; }
.tab-content.active { display: flex; }

.inputs-row {
  display: flex;
  flex-wrap: wrap;
  gap: 25px;
  width: 100%;
  justify-content: center;
  margin-bottom: 14px;
}

label { 
    font-size: 1.2rem; 
    margin-bottom: 6px; 
    display: block; 
    text-align: center; 
    transition: color 0.2s ease; /* Transition for label highlighting */
}

/* New CSS for active label */
.active-label-color {
    color: #00ccff; /* Bright color for Energy labels */
    text-shadow: 0 0 5px rgba(0,204,255,0.7);
}
.active-label-damage {
    color: #ff5555; /* Bright color for Damage labels */
    text-shadow: 0 0 5px rgba(255,85,85,0.7);
}

input, select {
  padding: 16px 20px;
  font-size: 1.3rem;
  border-radius: 14px;
  border: none;
  background: rgba(50,50,50,0.8);
  color: #cde4ff;
  text-align: center;
  width: 200px;
  box-shadow: 0 0 14px #3399ff;
  transition: box-shadow 0.2s ease;
}

input.damage-input, select.damage-input { box-shadow: 0 0 14px #ff3333; }
input:focus { box-shadow: 0 0 20px 5px #00aaff; }
input.damage-input:focus, select.damage-input:focus { box-shadow: 0 0 20px 5px #ff5555; }

/* Remove number input arrows */
input[type=number]::-webkit-inner-spin-button,
input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
input[type=number] { -moz-appearance: textfield; }

#output, #damageOutput {
  margin-top: 18px;
  font-size: 1.4rem;
  text-align: center;
  background: rgba(0,30,60,0.4);
  padding: 20px 30px;
  border-radius: 18px;
  box-shadow: 0 0 18px rgba(0,150,255,0.3);
  width: 100%;
}

.damage-output { color: #ff5555; text-shadow: 0 0 4px #ff8888; }

.collapsible { 
  background-color: rgba(0,30,60,0.4); 
  color: #cde4ff; 
  cursor: pointer; 
  padding: 12px 18px; 
  width: 100%; 
  max-width: 600px; 
  border-radius: 16px; 
  font-size: 1.1rem; 
  text-align: center; 
  margin-top: 20px; 
}

.content {
  padding: 0 18px; 
  max-width: 600px; 
  display: block; 
  overflow: hidden; 
  overflow-x: auto;
  white-space: nowrap;
  max-height: 0; 
  background-color: rgba(0,30,60,0.3);
  border-radius: 14px;
  margin-top: 6px;
  font-size: 1.05rem; 
  text-align: left; 
  line-height: 1.5; 
  transition: max-height 0.4s ease-out; 
}

.content.open {
  max-height: 320px; 
  padding: 16px 18px 12px 18px; 
}

.content::-webkit-scrollbar { height: 8px; }
.content::-webkit-scrollbar-thumb { background: rgba(0,102,255,0.5); border-radius: 4px; }
.content::-webkit-scrollbar-track { background: rgba(0,30,60,0.2); }

</style>
</head>
<body>

<div class="top-buttons">
  <button id="energyBtn" class="energy-btn active-btn energy">Energy Calculator</button>
  <button id="damageBtn" class="damage-btn">Damage Calculator</button>
</div>

<div id="energySection" class="section active">
  <h2>üîπ Energy Calculator üîπ</h2>
  <div class="notice">‚ö†Ô∏è Calculations are <strong>Real-Time</strong> and include the <strong>Fast Clicker Gamepass</strong> multiplier.</div>

  <div class="tabs">
    <button class="tab-btn active-tab energy" data-tab="perClickTab">Per Click</button>
    <button class="tab-btn" data-tab="targetTab">Target Energy</button>
    <button class="tab-btn" data-tab="rankTab">Rank Up</button>
  </div>

  <div id="perClickTab" class="tab-content active">
    <div class="inputs-row">
      <div><label for="pcEnergy" id="label-pcEnergy">Energy per Click</label><input type="text" id="pcEnergy" placeholder="44M"></div>
      <div><label for="pcTime" id="label-pcTime">Time (s)</label><input type="number" id="pcTime" value="1" min="1"></div>
    </div>
  </div>

  <div id="targetTab" class="tab-content">
    <div class="inputs-row">
      <div><label for="teEnergy" id="label-teEnergy">Energy per Click</label><input type="text" id="teEnergy" placeholder="44M"></div>
      <div><label for="targetEnergyInput" id="label-targetEnergyInput">Target Energy</label><input type="text" id="targetEnergyInput" placeholder="1T"></div>
      <div><label for="currentEnergyTarget" id="label-currentEnergyTarget">Current Energy</label><input type="text" id="currentEnergyTarget" placeholder="0"></div>
    </div>
  </div>

  <div id="rankTab" class="tab-content">
    <div class="inputs-row">
      <div><label for="rankEnergy" id="label-rankEnergy">Energy per Click</label><input type="text" id="rankEnergy" placeholder="44M"></div>
      <div><label for="rankInput" id="label-rankInput">Target Rank</label><input type="number" id="rankInput" min="1" placeholder="116"></div>
      <div><label for="currentEnergy" id="label-currentEnergy">Current Energy</label><input type="text" id="currentEnergy" placeholder="0"></div>
    </div>
  </div>

  <div id="output">Enter values to calculate.</div>

  <button type="button" class="collapsible">Show/Hide Supported Numbers</button>
  <div class="content" id="unitList">
    K, M, B, T, Qd, Qn, Sx, Sp, O, N, De, Ud, Dd, TdD, QdD, QnD, SxD, SpD, OcD, NvD, Vgn, UvG, DvG, Tvg, QtV, QnV, SeV, SpG, OvG, NvG, TgN, UTG, DTG, TsTG, QtTG, QnTG, SsTG, SpTG, OcTG, NoTG, QDDR, uQDR, dQDR, tQDR, qdQDR, QnQDR, SxQDR, SpQDR, OQDDR, NQDDR, qQGNT, uQGNT, dQGNT, tQGNT
  </div>
</div>

<div id="damageSection" class="section">
  <h2>ü©∏ Damage Calculator ü©∏</h2>

  <div class="tabs">
    <button class="tab-btn active-tab damage" data-tab="timeKillTab">Time to Kill</button>
    <button class="tab-btn" data-tab="requiredDpsTab">Required DPS</button>
  </div>

  <div id="timeKillTab" class="tab-content active">
    <div class="inputs-row">
      <div><label for="mobSelectTime">Select Mob</label>
        <select id="mobSelectTime" class="damage-input">
          <option value="">--Custom--</option>
          <option value="30.5qdQDR">Blood Queen</option>
          <option value="305QnQDR">Shadow</option>
          <option value="733SpQDR">Lord Boro</option>
          <option value="871NQDDR">Galaxy Hunter</option>
        </select>
      </div>
      <div><label for="dpsTime" id="label-dpsTime">DPS</label><input type="text" id="dpsTime" class="damage-input" placeholder="5M"></div>
      <div><label for="healthTime" id="label-healthTime">Mob Health</label><input type="text" id="healthTime" class="damage-input" placeholder="100M"></div>
    </div>
  </div>

  <div id="requiredDpsTab" class="tab-content">
    <div class="inputs-row">
      <div><label for="mobSelectDps">Select Mob</label>
        <select id="mobSelectDps" class="damage-input">
          <option value="">--Custom--</option>
          <option value="30.5qdQDR">Blood Queen</option>
          <option value="305QnQDR">Shadow</option>
          <option value="733SpQDR">Lord Boro</option>
          <option value="871NQDDR">Galaxy Hunter</option>
        </select>
      </div>
      <div><label for="desiredTimeDps" id="label-desiredTimeDps">Desired Time (s)</label><input type="number" id="desiredTimeDps" class="damage-input" placeholder="60"></div>
      <div><label for="healthDps" id="label-healthDps">Mob Health</label><input type="text" id="healthDps" class="damage-input" placeholder="100M"></div>
    </div>
  </div>

  <div id="damageOutput">Enter values to calculate.</div>

  <button type="button" class="collapsible">Show/Hide Supported Numbers</button>
  <div class="content" id="damageUnitList">
    K, M, B, T, Qd, Qn, Sx, Sp, O, N, De, Ud, Dd, TdD, QdD, QnD, SxD, SpD, OcD, NvD, Vgn, UvG, DvG, Tvg, QtV, QnV, SeV, SpG, OvG, NvG, TgN, UTG, DTG, TsTG, QtTG, QnTG, SsTG, SpTG, OcTG, NoTG, QDDR, uQDR, dQDR, tQDR, qdQDR, QnQDR, SxQDR, SpQDR, OQDDR, NQDDR, qQGNT, uQGNT, dQGNT, tQGNT
  </div>
</div>

<script>
// --- CORE UTILITY FUNCTIONS ---

// Units
const units = ["K","M","B","T","Qd","Qn","Sx","Sp","O","N","De","Ud","Dd","TdD","QdD","QnD","SxD","SpD","OcD","NvD","Vgn","UvG","DvG","Tvg","QtV","QnV","SeV","SpG","OvG","NvG","TgN","UTG","DTG","TsTG","QtTG","QnTG","SsTG","SpTG","OcTG","NoTG","QDDR","uQDR","dQDR","tQDR","qdQDR","QnQDR","SxQDR","SpQDR","OQDDR","NQDDR","qQGNT","uQGNT","dQGNT","tQGNT"];
const unitMap = {}; units.forEach((u,i)=>{ unitMap[u.toLowerCase()]=Math.pow(10,3*(i+1)); });

function parseEnergy(input){ 
    input=String(input).trim(); 
    const m=input.match(/^([\d.]+)\s*([a-zA-Z]+)?$/); 
    if(!m)return 0; 
    const n=parseFloat(m[1]); 
    const u=m[2]?m[2].toLowerCase():""; 
    if(!u)return n; 
    if(unitMap.hasOwnProperty(u)) return n*unitMap[u]; 
    return 0; 
}
function formatUnits(value){ 
    for(let i=units.length-1;i>=0;i--){ 
        let uv=Math.pow(10,3*(i+1)); 
        if(value>=uv) return (value/uv).toFixed(3)+" "+units[i]; 
    } 
    return value.toFixed(value >= 1 ? 3 : 6); 
}

// --- CALCULATION LOGIC ---

function calcPerClick(){ 
    const e=parseEnergy(document.getElementById("pcEnergy").value); 
    const t=parseFloat(document.getElementById("pcTime").value); 
    const out=document.getElementById("output"); 

    if(e>0 && t>0){ 
        const eps=e*5.5; 
        const total=eps*t; 
        out.innerHTML=`‚ö° <strong>Energy per second:</strong> ${formatUnits(eps)}<br>‚è±Ô∏è <strong>Energy after ${t} s:</strong> ${formatUnits(total)}`; 
        return;
    } 
    out.innerHTML="‚ö†Ô∏è Enter valid Energy per Click and Time."; 
}

function calcTarget(){ 
    const e=parseEnergy(document.getElementById("teEnergy").value); 
    const target=parseEnergy(document.getElementById("targetEnergyInput").value); 
    const current=parseEnergy(document.getElementById("currentEnergyTarget").value); 
    const out=document.getElementById("output"); 
    
    if(e>0 && target>0){ 
        const eps=e*5.5; 
        const remaining=Math.max(target-current, 0); 
        
        if (remaining === 0) {
            out.innerHTML = `‚úÖ <strong>Target Reached!</strong>`;
            return;
        }

        const time=remaining/eps; 
        
        out.innerHTML=`üéØ <strong>Energy Needed:</strong> ${formatUnits(remaining)}<br>‚ö° <strong>Energy per second:</strong> ${formatUnits(eps)}<br>‚è±Ô∏è <strong>Time required:</strong> ${time.toFixed(2)} s`; 
        return;
    } 
    out.innerHTML="‚ö†Ô∏è Enter valid Energy per Click and Target Energy."; 
}

const rankEnergyMap = { 116: parseEnergy("30tsTG"),117: parseEnergy("150tsTG"),118: parseEnergy("750tsTG"),119: parseEnergy("90qtTG"),120: parseEnergy("900qtTG") };
function calcRank(){ 
    const r=parseInt(document.getElementById("rankInput").value); 
    const e=parseEnergy(document.getElementById("rankEnergy").value); 
    const current=parseEnergy(document.getElementById("currentEnergy").value); 
    const out=document.getElementById("output"); 

    if(r <= 0 || isNaN(r)) { out.innerHTML="‚ö†Ô∏è Enter a valid Rank number."; return; }

    if(!rankEnergyMap[r]){ 
        out.innerHTML=`‚ö†Ô∏è Rank ${r} energy cost not defined. (Only Ranks 116-120 supported)`; 
        return; 
    } 
    if(e<=0){ 
        out.innerHTML="‚ö†Ô∏è Enter valid Energy per Click."; 
        return; 
    } 
    
    const eps=e*5.5; 
    const req=rankEnergyMap[r]; 
    const remaining=Math.max(req-current,0); 
    const time=remaining/eps; 

    out.innerHTML=`üèÜ <strong>Rank ${r} Energy Required:</strong> ${formatUnits(req)}<br>‚ö° <strong>Energy per second:</strong> ${formatUnits(eps)}<br>‚è±Ô∏è <strong>Time to reach Rank ${r}:</strong> ${time.toFixed(2)} s`; 
}

function calcTimeKill(){ 
  const dps=parseEnergy(document.getElementById("dpsTime").value);
  const health=parseEnergy(document.getElementById("healthTime").value);
  const out=document.getElementById("damageOutput");

  if(dps>0 && health>0){
    const time=health/dps;
    out.innerHTML=`ü©∏ <strong class="damage-output">Time to kill:</strong> <span class="damage-output">${time.toFixed(2)} s</span>`;
  } else out.innerHTML="‚ö†Ô∏è Enter valid DPS and Mob Health values.";
}

function calcRequiredDps(){
  const time=parseFloat(document.getElementById("desiredTimeDps").value);
  const health=parseEnergy(document.getElementById("healthDps").value);
  const out=document.getElementById("damageOutput");

  if(time>0 && health>0){
    const requiredDPS=health/time;
    out.innerHTML=`‚ö° <strong class="damage-output">Required DPS for ${time}s:</strong> <span class="damage-output">${formatUnits(requiredDPS)}</span>`;
  } else out.innerHTML="‚ö†Ô∏è Enter valid Mob Health and Desired Time values.";
}

// --- UX / EVENT LISTENERS ---

function handleInputEvent() {
    // 1. Save data to Local Storage
    localStorage.setItem(this.id, this.value);
    
    // 2. Run the correct calculation based on input's parent tab
    const parentTab = this.closest('.tab-content').id;
    if (parentTab === 'perClickTab') calcPerClick();
    else if (parentTab === 'targetTab') calcTarget();
    else if (parentTab === 'rankTab') calcRank();
    else if (parentTab === 'timeKillTab') calcTimeKill();
    else if (parentTab === 'requiredDpsTab') calcRequiredDps();
}

function handleMobSelection(e) {
    // Check which select changed
    const isTimeKill = e.target.id === 'mobSelectTime';
    const healthInputId = isTimeKill ? "healthTime" : "healthDps";
    const calcFunction = isTimeKill ? calcTimeKill : calcRequiredDps;

    // Update health field and save
    if(e.target.value) {
        document.getElementById(healthInputId).value = e.target.value;
        localStorage.setItem(healthInputId, e.target.value);
    }
    calcFunction();
}


function setupListeners() {
    const inputs = document.querySelectorAll('input[type="text"], input[type="number"]');
    
    inputs.forEach(input => {
        // --- 1. LOCAL STORAGE: Load Data ---
        const savedValue = localStorage.getItem(input.id);
        if (savedValue !== null) {
            input.value = savedValue;
        }

        // --- 2. REAL-TIME CALCULATION & LOCAL STORAGE: Save Data ---
        input.addEventListener("input", handleInputEvent);

        // --- 3. AESTHETICS: Label Highlighting ---
        const label = document.getElementById(`label-${input.id}`);
        if (label) {
            const isDamage = input.classList.contains('damage-input');
            const activeClass = isDamage ? 'active-label-damage' : 'active-label-color';
            
            input.addEventListener('focus', () => label.classList.add(activeClass));
            input.addEventListener('blur', () => label.classList.remove(activeClass));
        }
    });

    // Mob Selection Listeners
    document.getElementById("mobSelectTime").addEventListener("change", handleMobSelection);
    document.getElementById("mobSelectDps").addEventListener("change", handleMobSelection);
    
    // UI Logic 
    const energyBtn = document.getElementById("energyBtn");
    const damageBtn = document.getElementById("damageBtn");
    const energySection = document.getElementById("energySection");
    const damageSection = document.getElementById("damageSection");

    // FUNCTION TO SELECT THE SECTION AND TAB
    function selectSectionAndTab(section, tabId) {
        // 1. Set the main section
        if (section === 'energy') {
            energySection.classList.add("active"); damageSection.classList.remove("active");
            energyBtn.classList.add("active-btn", "energy"); damageBtn.classList.remove("active-btn", "damage");
            localStorage.setItem('activeSection', 'energy');
        } else {
            damageSection.classList.add("active"); energySection.classList.remove("active");
            damageBtn.classList.add("active-btn", "damage"); energyBtn.classList.remove("active-btn", "energy");
            localStorage.setItem('activeSection', 'damage');
        }
        
        const tabsContainerId = (section === 'energy') ? 'energySection' : 'damageSection';
        const tabBtns = document.querySelectorAll(`#${tabsContainerId} .tab-btn`);
        const tabContents = document.querySelectorAll(`#${tabsContainerId} .tab-content`);
        const isDamage = section === 'damage';

        // 2. Set the active tab
        tabBtns.forEach(t => t.classList.remove("active-tab", "energy", "damage"));
        tabContents.forEach(c => c.classList.remove("active"));
        
        const targetTabBtn = document.querySelector(`[data-tab="${tabId}"]`);
        const targetTabContent = document.getElementById(tabId);
        
        if (targetTabBtn && targetTabContent) {
            targetTabBtn.classList.add("active-tab");
            targetTabBtn.classList.add(isDamage ? "damage" : "energy");
            targetTabContent.classList.add("active");
            localStorage.setItem('activeTab', tabId);

            // 3. Run the correct calculation for the shown tab
            if(tabId === 'perClickTab') calcPerClick();
            else if(tabId === 'targetTab') calcTarget();
            else if(tabId === 'rankTab') calcRank();
            else if(tabId === 'timeKillTab') calcTimeKill();
            else if(tabId === 'requiredDpsTab') calcRequiredDps();
        }
    }
    
    // Bind main button listeners
    energyBtn.addEventListener("click",()=>selectSectionAndTab('energy', localStorage.getItem('activeTab') || 'perClickTab'));
    damageBtn.addEventListener("click",()=>selectSectionAndTab('damage', localStorage.getItem('activeTab') || 'timeKillTab'));

    // Tabs generic binding (now calls the persistence function)
    function setupTabs(tabParentId, isDamage=false){
      const tabBtns = document.querySelectorAll(`#${tabParentId} .tab-btn`);
      const section = isDamage ? 'damage' : 'energy';
      
      tabBtns.forEach(tab=>{
        tab.addEventListener("click", ()=>{
          selectSectionAndTab(section, tab.dataset.tab);
        });
      });
    }
    setupTabs('energySection', false);
    setupTabs('damageSection', true);


    // Collapsibles 
    document.querySelectorAll(".collapsible").forEach(c=>{
      c.addEventListener("click",()=>{ 
        const cont=c.nextElementSibling; 
        cont.classList.toggle('open');
      });
    });

    // --- INITIALIZATION ON LOAD ---
    const savedSection = localStorage.getItem('activeSection') || 'energy';
    let savedTab = localStorage.getItem('activeTab');
    
    // Default the tab based on the section if no tab is saved, or if saved tab is for the wrong section
    if (savedSection === 'energy') {
        savedTab = savedTab || 'perClickTab';
        if (savedTab.includes('Kill') || savedTab.includes('Dps')) savedTab = 'perClickTab';
    } else { // damage section
        savedTab = savedTab || 'timeKillTab';
        if (savedTab.includes('Click') || savedTab.includes('target') || savedTab.includes('rank')) savedTab = 'timeKillTab';
    }
    
    selectSectionAndTab(savedSection, savedTab);
}

document.addEventListener('DOMContentLoaded', setupListeners);
</script>
</body>
</html>
